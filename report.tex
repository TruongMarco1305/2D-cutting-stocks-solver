\documentclass[a4paper]{article}
\usepackage{import}
%\usepackage[english,vietnam]{babel}
\usepackage[utf8]{inputenc}
%\usepackage[utf8]{inputenc}
%\usepackage[francais]{babel}
\usepackage{a4wide,amssymb,epsfig,latexsym,array,hhline,fancyhdr}
\usepackage[normalem]{ulem}
%\usepackage{soul}
\usepackage[noend]{algpseudocode} % Loại bỏ từ khóa 'end' để tiết kiệm không gian
\usepackage{algpseudocode}
\usepackage{pgffor}       % Để sử dụng vòng lặp \foreach
\usepackage{listings}
\usepackage{algorithm}
\usepackage{colortbl}
\usepackage[makeroom]{cancel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{multicol,longtable,amscd}
\usepackage{diagbox}%Make diagonal lines in tables
\usepackage{booktabs}
\usepackage{alltt}
\usepackage[framemethod=tikz]{mdframed}% For highlighting paragraph backgrounds
\usepackage{caption,subcaption}

\usepackage{lastpage}
\usepackage[lined,boxed,commentsnumbered]{algorithm2e}
\usepackage{enumerate}
\usepackage{color}
\usepackage{graphicx}							% Standard graphics package
\usepackage{array}
\usepackage{tabularx, caption}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{float} 
\usepackage{rotating}
\usepackage{graphics}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{epsfig}
\usepackage{minted}
\usepackage{xcolor} % to access the named colour LightGray
\definecolor{LightGray}{gray}{0.9}
\usemintedstyle{emacs}
\usepackage{tikz}
\usetikzlibrary{graphs,graphs.standard}
\usetikzlibrary{arrows,snakes,backgrounds}
\usepackage[unicode]{hyperref}
\hypersetup{
    urlcolor=blue,
    linkcolor=black,
    citecolor=black,
    colorlinks=true,
    pdfpagemode=FullScreen,
    pdftitle={The Travelling Salesman Problem},
} 
%\usepackage{pstcol} 								% PSTricks with the standard color package
%\usepackage{background}
%\backgroundsetup{contents=\includegraphics{Images/hcmut.png}, scale=0.5, opacity=0.25, angle = 0}
\usepackage[normalem]{ulem}

\def\thesislayout{	% A4: 210 × 297
	\geometry{
		a4paper,
		total={160mm,240mm},  % fix over page
		left=30mm,
		top=30mm,
	}
}
\thesislayout

\usepackage{fancyhdr}
\setlength{\headheight}{40pt}
\pagestyle{fancy}
\fancyhead{} % clear all header fields
\fancyhead[L]{
 \begin{tabular}{rl}
    \begin{picture}(25,15)(0,0)
    \put(0,-8){\includegraphics[width=8mm, height=8mm]{Images/hcmut.png}}
    %\put(0,-8){\epsfig{width=10mm,figure=hcmut.eps}}
   \end{picture}&
	%\includegraphics[width=8mm, height=8mm]{hcmut.png} & %
	\begin{tabular}{l}
		\textbf{\textcolor{blue}{\bf \ttfamily Ho Chi Minh City University of Technology}}\\
		\textbf{\textcolor{blue}{\bf \ttfamily Faculty of Computer Science and Engineering}}
	\end{tabular} 	
 \end{tabular}
}
\fancyhead[R]{
	\begin{tabular}{l}
		\tiny \bf \\
		\tiny \bf 
	\end{tabular}  }
\fancyfoot{} % clear all footer fields
\fancyfoot[L]{\scriptsize \ttfamily Truong Gia Ky Nam - 2352787}
\fancyfoot[R]{\scriptsize \ttfamily Page {\thepage}/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0.3pt}


%%%
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{3}
\makeatletter
\newcounter {subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection .\@alph\c@subsubsubsection}
\newcommand\subsubsubsection{\@startsection{subsubsubsection}{4}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\normalfont\normalsize\bfseries}}
\newcommand*\l@subsubsubsection{\@dottedtocline{3}{10.0em}{4.1em}}
\newcommand*{\subsubsubsectionmark}[1]{}
\makeatother

\sloppy
\captionsetup[figure]{labelfont={small,bf},textfont={small,it},belowskip=-1pt,aboveskip=-9pt}
%space remove between caption, figure, and text
\captionsetup[table]{labelfont={small,bf},textfont={small,it},belowskip=-1pt,aboveskip=7pt}
%space remove between caption, table, and text

%\floatplacement{figure}{H}%forced here float placement automatically for figures
%\floatplacement{table}{H}%forced here float placement automatically for table
%the following settings (11 lines) are to remove white space before or after the figures and tables
%\setcounter{topnumber}{2}
%\setcounter{bottomnumber}{2}
%\setcounter{totalnumber}{4}
%\renewcommand{\topfraction}{0.85}
%\renewcommand{\bottomfraction}{0.85}
%\renewcommand{\textfraction}{0.15}
%\renewcommand{\floatpagefraction}{0.8}
%\renewcommand{\textfraction}{0.1}
\setlength{\floatsep}{5pt plus 2pt minus 2pt}
\setlength{\textfloatsep}{5pt plus 2pt minus 2pt}
\setlength{\intextsep}{10pt plus 2pt minus 2pt}

\thesislayout



\begin{document}
\begin{titlepage}
\begin{center}
\textbf{\Large VIETNAM NATIONAL UNIVERSITY HO CHI MINH CITY} \\

\vspace{7pt}
\textbf{\Large HO CHI MINH CITY UNIVERSITY OF TECHNOLOGY} \\

\vspace{7pt}
\textbf{\Large FACULTY OF COMPUTER SCIENCE AND ENGINEERING}
\end{center}

\vspace{1cm}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=3cm]{Images/hcmut.png}
\end{center}
\end{figure}

\vspace{1cm}


\begin{center}
\begin{tabular}{ccc}
	\multicolumn{3}{l}{\textbf{{\Large \textcolor{blue}{MATHEMATICAL MODELING (CO2011)}}}}\\
	~~\\
	\arrayrulecolor{blue}\hline
	\\
	\multicolumn{3}{l}{\textbf{{\Large \textcolor{blue}{Assignment} }}}\\
	\\
	
	\multicolumn{3}{c}{\textbf{{\Huge \textcolor{blue}{“Cutting Stock Problem”}}}}\\
	\\
    
	\arrayrulecolor{blue}\hline \\ \\

    \multicolumn{1}{r}{\textbf{\Large Instructors:}} & \multicolumn{2}{l}{\Large Nguyen Van Minh Man, \textit{Mahidol University}} \\ \\
    \multicolumn{1}{r}{} & \multicolumn{2}{l}{\Large Le Hong Trang, \textit{CSE-HCMUT}} \\ \\

    \\ \\

    \multicolumn{1}{r}{\Large \textbf{Students:}} & \multicolumn{2}{l}{\Large Truong Gia Ky Nam - 2352787 (Group CC05 - Team 01)} \\ \\

    \multicolumn{1}{r}{} & \multicolumn{2}{l}{\Large Nguyen Huu Phuc - 2352938 (Group CC05 - Team 01)} \\ \\

    \multicolumn{1}{r}{} & \multicolumn{2}{l}{\Large Tran Bao Phuc Long - 2352703 (Group CC05 - Team 01)} \\ \\

    \multicolumn{1}{r}{} & \multicolumn{2}{l}{\Large Nguyen Thanh Hieu - 2352331 (Group CC05 - Team 01)} \\ \\

    \multicolumn{1}{r}{} & \multicolumn{2}{l}{\Large Chau Anh Nhat - 2352856 (Group CC05 - Team 01)} \\ \\

\end{tabular}
\end{center}

\vspace{2cm}

\begin{center}
{\textbf{\Large Ho Chi Minh City, November 2024}}
\end{center}
\end{titlepage}

\thispagestyle{empty}
\setcounter{page}{-1}
\newpage
\begin{abstract}
    \noindent     
    The Cut Stock Problem (CSP) is a well optimization challenge in Operations Research and Industrial Engineering. It involves determining the most efficient way to cut smaller required lengths (orders) from a standard larger length (stock), with the goal of minimizing waste. This problem is prevalent in industries such as paper, steel, and textiles, where materials are manufactured in standard sizes and must be cut to meet specific customer demands. The complexity of CSP increases with the diversity of order sizes and the need to satisfy all demands exactly. Various approaches, including dynamic programming, column generation, and heuristic methods, have been proposed to address the problem. This report investigates the application of the Branch and Bound algorithm, a combinatorial optimization technique, to solve the CSP. The Branch and Bound method systematically explores the solution space by branching and applying bounding strategies to eliminate suboptimal solutions, thereby reducing the search space. The report also provides a detailed implementation of the algorithm and its performance analysis based on research findings.
\end{abstract}
\newpage

\setcounter{page}{0}
\thispagestyle{empty}
\newpage
\tableofcontents
\newpage

%\thispagestyle{empty}
\section{Introduction}
The Cutting Stock Problem (CSP) is a classic optimization challenge that arises in various industries. Introduced by P.C.Gilmore and R.E.Gomory in the 1960s, CSP has evolved significantly, impacting businesses such as manufacturing, textiles, and packaging, where material efficiency directly influences costs. The core objective of CSP is to determine how to cut larger stock materials into smaller pieces to meet demand while minimizing waste and maximizing the use of available resources. Due to its combinatorial nature and the exponential growth of potential solutions, the CSP is considered an NP-hard problem, requiring specialized algorithms and methods for practical solutions. 
\subsection{Historical background and evolution}
The initial work on the CSP focused on one-dimensional variants, where materials like paper rolls were cut into narrower strips. Gilmore and Gomory developed mathematical programming models and solution methodologies that laid the groundwork for modern research. Their approach utilized linear programming with column generation, which proved to be a significant step toward solving large-scale instances of the problem efficiently.

Over time, research expanded to two-dimensional and multi-dimensional variants, which are more applicable to industries dealing with sheets of material rather than simple linear rolls. The Two-Dimensional Cutting Stock Problem (2D CSP) emerged as an important field of study, with methods being adapted to handle complexities related to layout, orientation, and multiple constraints.
\subsection{Significance in Various Industries}
The CSP holds great importance in industries that prioritize material efficiency and cost reduction. For instance:
\begin{itemize}
    \item \textbf{Manufacturing:}  Metalworking, glass cutting, and wood processing plants need to optimize their cutting patterns to minimize scrap and meet production quotas.
    \item \textbf{Textiles:}  The fashion and upholstery sectors face challenges in cutting fabrics into specific shapes with minimal waste.
    \item \textbf{Printing and Packaging:}  Paper manufacturers and packaging companies use CSP solutions to optimize the cutting of large sheets into smaller pieces for printed materials or packaging designs.
    \item \textbf{Logistics and Construction:}  Industries that deal with materials like plastic or insulation sheets also benefit from optimized cutting stock solutions.
An effective CSP solutions improve operational efficiency, lower material costs, and support sustainability initiatives by reducing waste.
\end{itemize}
\subsection{Mathematical Models Used in CSP}
Over the years, various mathematical models have been developed to represent and solve the CSP. These models differ based on the nature of the problem (e.g., one-dimensional or multi-dimensional) and the complexity of constraints involved. Some of the common models include:
\begin{itemize}
    \item \textbf{Linear Programming (LP) and Integer Linear Programming (ILP):}  Core methods for exact solutions, employing column generation to optimize cutting patterns by solving sub-problems iteratively.
    \item \textbf{Knapsack-Based Models:} Represent CSP as an extension of the knapsack problem, focusing on maximizing the use of stock material within capacity limits.
    \item \textbf{Mixed-Integer Programming (MIP):}  Used for problems with additional constraints, such as minimizing the number of distinct cutting patterns or incorporating production costs.
    \item \textbf{Greedy Heuristics and Constructive Methods:}  These offer quick, practical solutions, generating an initial arrangement that can be refined using more advanced optimization methods. Common examples include First-Fit Decreasing (FFD) and Best-Fit Decreasing (BFD) heuristics.
\end{itemize}

\subsection{Goal}
The 2-dimensional cutting stock problem (2D CSP)  is a type of optimization problem where the goal is to cut smaller rectangular items from larger rectangular sheets of material in a way that minimizes the area of used stocks if a fixed number of sheets are used. It is commonly encountered in manufacturing and production industries where efficient material usage is essential for cost savings.

\section{Acknowledge}
\subsection{Categorizing the Problem}
The 2-dimensional cutting stock problem can be differentiate into many kinds of problem based on these factors:

\begin{itemize}
    \item \textbf{Types of Cutting Patterns:}
    \begin{itemize}
    \item Guillotine Cuts: Each cut must go from one edge of the material to the other, simplifying the cutting process. Guillotine cutting is often preferred because it's easier to automate and more practical in large-scale manufacturing.
    \item Non-Guillotine Cuts: Cuts don’t have to span the entire length or width, which can lead to more efficient use of material but is usually harder to implement due to increased cutting complexity.
\end{itemize}
\item \textbf{Types of Stocks:}
The problem will provides the number of stocks to work with, ranging from one single stock to infinite.
\item \textbf{Orientation Constraints:}
The stock pieces can be freely rotated in any directions or must remain in a specific orientation depends on the stock's properties
\item \textbf{Shape of Stock:} The stock can be rectangle, which will be easy to solve and cut or it can have arbitrary shapes which requires a more complex approach to solve

\item \textbf{Common problems:} Based on the final goal of the problem, we can create many variation of this problem. We mainly deal with these 4 types:
\begin{itemize}
    \item \textbf{2-dimensional strip packing problem:} Given a single bin B with fixed width W and infinite height, this problem's demand is to fit a packing of products that use minimal height.
    \item \textbf{2-dimensional knapsack problem:} Given a value V to each item in our stock S, each item's value can be different, the goal is to fit the most items of S in a single bin B that have the highest sum of value.
    \item \textbf{2-dimensional bin stacking problem:} We have an infinite amount of identical bin B that have height H and width W along with a finite amount of item called set I. This problem wants us to divide set I into minimum subsets such that each subset can be put inside a bin B, this can be rewritten as this problem wants us to use the least number of bin B to put all of set I's items inside.
    \item \textbf{2-dimensional orthogonal packing problem:} This problem simply asks if there is a pattern to pack a given set of items I into a single bin B or a set of bin B. 
\end{itemize}

\end{itemize}


\subsection{Main Problem Definition}
\begin{itemize}
    \item \textbf{Input Stock Material:} You start with a set of multi-sized stocks for each stock there is limit for quantity, which serves as the stock from which smaller pieces are cut. In this report, we consider 2 stages guillotine cut and we allow trimming ( a third stage cut can be used to separate a rectangle from a waste area ) 
    \item \textbf{Demanded Pieces:} There’s a set of smaller stock, each with specific size and demand (rotation is allowed), that must be cut from the stocks.
    \item \textbf{Goal: }The objective is to cut the demanded pieces from the stock in a way that minimizes the area of used stocks if a fixed number of sheets are used which means minimizes the filled ratio.

    
note: filled ratio = area of used stocks / total area of stocks
\end{itemize}



\subsection{Types of Constraints}
Several constraints typically govern the solution:
    \begin{itemize}
    
    \item \textbf{Constraint for the demand of each item type:} Each demanded piece must be produced in the required quantity.

    
    \item \textbf{Constraints for the quantity of each stock type:} Do not use over the limit of the quantity of each stock type 
\end{itemize}

\subsection{Difficulties in Solving 2D CSP:}
\begin{itemize}
    
    \item \textbf{Piece Size and Shape Diversity:}
    \begin{itemize}
        \item The pieces have different dimensions, some long and narrow, others square or almost square. This variety complicates the arrangement, as pieces cannot easily “tessellate” or fit together like a puzzle without leaving gaps.
        \item Large pieces reduce flexibility in the arrangement, limiting the space left for smaller pieces.
        \item The pieces cannot overlap on the stock sheet; each piece must occupy a unique position.
    \end{itemize}
    \item \textbf{Constraint of Available Material Dimensions:}
    \begin{itemize}
        \item Since the stock sheet is a fixed size, there's a risk of not fitting all pieces if the layout isn’t planned carefully.
        \item In some configurations, certain pieces might not fit, forcing the need to use additional sheets
    \end{itemize}
    
\end{itemize}

\subsection{Real-World Difficulties in Solving 2D CSP:}
\begin{itemize}
    \item \textbf{Computational Complexity:} Finding the optimal layout among all possible arrangements is computationally intensive, especially with larger sheets and a wide variety of parts.
    \item \textbf{Material Costs:} High-value materials add pressure to reduce waste as much as possible. An inefficient layout could significantly increase material costs.
    \item \textbf{Production Flexibility:} Factories often handle multiple types of materials and need to switch between layouts quickly. This flexibility is hard to balance with the need for material efficiency.
    \item \textbf{Cutting Constraints:} Certain materials or machines may have cutting constraints (minimum cut width, grain direction for wood or textiles), which restrict how pieces can be oriented and add further complexity.
    \item \textbf{Time constraints:} Low time budget might prevent global optimization methods, so near-optimal or heuristic approaches are often required, risking suboptimal results.
\end{itemize}

\subsection{General Solutions: }
\begin{itemize}
    \item \textbf{Exact Finding Methods:} Linear Programming(LP), Mixed-Integer Linear Programming (MILP)
    \item \textbf{Heuristics and Metaheuristics Methods:} Greedy algorithms, First Fit and Best Fit strategies, Genetics algorithms, simulated annealing and tabu search
    \item \textbf{Hybrid Approaches:} Combining heuristics and optimization and decomposition techniques
\end{itemize}
\section{Algorithm} 
\subsection{Lazy Initialization:}
The lazy stock initialization heuristic in the 2-dimensional cutting stock problem is a strategy that defers the evaluation of product combinations and strip configurations until they are needed during the optimization process. Instead of precomputing all possible product placements for each strip, the algorithm dynamically evaluates configurations only when required, reducing computational overhead and memory usage. This approach allows the algorithm to focus on the most promising product combinations, initializing and placing products as necessary based on the current iteration. As strips are filled, leftover space is addressed by lazily evaluating potential fits for additional products. While this heuristic helps save resources and provides flexibility, it may lead to increased runtime when a deferred configuration is eventually needed and can complicate implementation due to the need to manage on-the-fly evaluations. Overall, lazy stock initialization improves scalability and adaptability in solving large-scale cutting stock problems.


\begin{minted}[frame=lines, framesep=2mm, baselinestretch=1.2, fontsize=\footnotesize, linenos, breaklines=true]{python}
Initialization
    Define bucket_size = 10 // This means each bucket will cover a size range of 10 units of stock_w and stock_h
    Create empty dictionary stock_buckets = {} // Key in bucket is the bucket ranges
    Set best_stock_idx = -1, best_position = None, best_prod_size = [0,0]
    Sort products in descending order of area on the first time running // Sort stock in ascending order of area (optional)
Group stock into buckets:
    For each stock:
        Calculate bucket key = dimensions // bucket_size
            Assign stock to appropriate bucket
Iteration
    For each product:
        If product quantity > 0:
            Get size of product
            Set minimum_waste_percent = inf
            For each candidate stock: // From the grouped buckets, retrieve stocks that are large enough to potentially fit the product using keys
                Check if product can be placed in the stock by iterate through position in the stock
                    If can, calculate the waste percentage as the unused area in the stock
                    Update the best_stock_idx, position and prod_size if has lower waste_percentage
Return result
    If suitable placement is found:
        Reduce the quantity by 1
        Return prod_idx, stock_idx and position
    Else
        Return stock_idx = -1, size = [0, 0], position = None
\end{minted}

\noindent\textbf{Advantages:} 
\begin{itemize}
        \item \textbf{Reduced Initial Overhead:} By not precomputing all product layouts in advance, the algorithm decreases upfront computational time and resource consumption.
        \item \textbf{Lower Memory Usage:} Since it avoids storing all potential configurations, the approach conserves memory, which is especially beneficial for large-scale problems.
        \item \textbf{Focus on Promising Configurations:} The method only evaluates configurations when needed, allowing it to concentrate on those most likely to improve the solution.
        \item \textbf{Flexibility:} As the solution space evolves, the algorithm can adaptively evaluate new product placements without being constrained by predetermined layouts.
        \item \textbf{Scalability:} By reducing initial computation and memory demands, the method can handle larger problem instances more efficiently.
    \end{itemize}

\vspace{0.35cm}

\noindent\textbf{Disadvantages:}
\begin{itemize}
        \item \textbf{Potential Increased Runtime on Demand:} Delaying the evaluation of certain configurations may lead to longer runtimes when these configurations are eventually required.
        \item \textbf{Implementation Complexity:} Managing on-the-fly evaluation of configurations is more intricate, increasing the complexity of coding and maintenance.
        \item \textbf{Uncertain Runtime Behavior:} Because configurations are evaluated as needed, predicting the overall runtime is more challenging.
        \item \textbf{Need for Effective Search Strategies:} To realize the full benefits of lazy evaluation, the search strategy must be well-designed to avoid excessive deferred computations.
    \end{itemize}

\subsection{Column Generation}
Column generation is a precise and iterative optimization technique specifically designed to solve the cutting stock problem efficiently, particularly when the master problem is exponentially large. The process begins by establishing a restricted master problem (RMP), which includes only a manageable subset of patterns derived from initial heuristic methods to avoid the complexity of the full exponential master problem. This RMP is then solved as a linear programming problem to obtain a fractional solution. The dual variables from this solution are used to identify new patterns with negative reduced costs by solving a two-dimensional knapsack problem for each bin class, ensuring that only the most promising patterns are considered. Once these new patterns are generated, they are added to the RMP, and the master problem is re-optimized. This cycle of solving the RMP, generating new patterns using the dual variables, and re-optimizing continues iteratively. The algorithm terminates when no additional patterns with negative reduced costs can be found, indicating that the optimal solution to the cutting stock problem has been reached. By restricting the master problem to a subset of patterns and systematically expanding it with beneficial patterns, column generation effectively manages the exponential complexity, ensuring an exact and optimal solution.
\vspace{0.25cm}
\begin{minted}[frame=lines, framesep=2mm, baselinestretch=1.2, fontsize=\footnotesize, linenos, breaklines=true]{python}
Input:
    products, demands, stocks

Output:
    optimal_stocks, total_stocks_used

Initialization
    patterns ← generate_initial_patterns(products, stocks)  # Generate feasible initial patterns
    RMP ← setup_rmp(patterns, demands)  # Set up restricted master problem (RMP)
    dual_prices ← []  # Initialize dual prices list

Solve RMP using column generation
    while True:
        solve_linear_program(RMP)  # Solve linear relaxation of RMP
        dual_prices ← extract_dual_prices(RMP)  # Get dual prices from solved RMP
    
        # Generate new patterns using dual prices
        new_patterns ← solve_knapsack(products, stocks, dual_prices)  # Solve knapsack problem
        if reduced_cost(new_patterns, dual_prices) ≥ 0:  # Check if new pattern improves solution
            break  # Stop if no new patterns can improve the objective
        add_pattern_to_rmp(RMP, new_patterns)  # Add new pattern to RMP if improvement is possible
    
    Extract Final Solution by solving RMP as an integer program
    final_solution ← solve_integer_program(RMP)

Format Output
    optimal_stocks ← []  # Initialize list to store optimal patterns
    total_stocks_used ← 0  # Initialize counter for total stocks used
    for pattern in final_solution:  # Iterate over final solution patterns
        if pattern.usage > 0:  # Only include patterns used in the solution
            optimal_stocks.append(pattern)  # Add pattern to optimal stocks
            total_stocks_used += pattern.usage  # Accumulate total usage

Return Result
    print(total_stocks_used)  # Optionally print the result for user reference
    return optimal_stocks  # Return list of optimal stocks
\end{minted}
\noindent\textbf{Subproblems in column generation:} 
\begin{itemize}
    \item \textbf{Initial heuristics:} This technique provides a straightforward method for generating feasible solutions to the two-dimensional cutting stock problem. One widely used heuristic is the strip packing approach, where items are sorted by dimensions (width and length) and then packed into strips that align with guillotine cutting constraints. In this process:
\begin{itemize}     
    \item Items are first sorted in descending order by width, and ties are broken by length.     
    \item Strips are created to fit as many items as possible without exceeding the dimensions of the bin.      
    \item A greedy filling approach is used to fill any remaining space in the strips with smaller items. 
\end{itemize}
\item \textbf{Pattern Generation (Knapsack problem): }
This algorithm for pattern generation in solving the 2-dimensional cutting stock problem involves several key steps:
\begin{itemize}
    \item Determine the possible strip layouts based on the product types, considering both the original and rotated orientations of each product.
    \item Evaluate how many pieces of each product type can fit into each strip, ensuring minimal waste.
    \item After the initial product allocation, optimize the strip’s capacity by:
    \begin{itemize}
        \item Checking for leftover space.
        \item Attempting to fill leftover space with additional products from other product types.
        \item Exploring all feasible combinations for filling.
    \end{itemize}
    \item Store these valid configurations in a ``strip list'' for later evaluation.
    \item Calculate the total profit for each combination using the profit margins of the products.
    \item Check if the combination meets the demand for the required number of items.
    \item Identify and return the most profitable configuration that satisfies the demand and is feasible.
    
\begin{minted}[frame=lines, framesep=2mm, baselinestretch=1.2, fontsize=\footnotesize, linenos, breaklines=true]{python}
Initialize:
    bucket_size ← 10
    stock_buckets ← empty dictionary
    best_stock ← (-1, None, [0, 0])
    sort products by descending area
    sort stocks by ascending area (optional)

Group Stocks into Buckets:
    for each stock in stocks:
        key ← (stock.width // bucket_size, stock.height // bucket_size)
        add stock to stock_buckets[key]

Place Products:
    for each product in products:
        if product.quantity > 0:
            min_waste ← ∞
            for each stock in get_candidate_stocks(product, stock_buckets, bucket_size):
                for each position in possible_positions(stock):
                    if can_place(product, stock, position):
                        waste ← calculate_unused_area(stock, product, position)
                        if waste < min_waste:
                            best_stock ← (stock.id, position, [product.width, product.height])
                            min_waste ← waste
            if best_stock.id ≠ -1:
                product.quantity −= 1
                return best_stock

Return:
    return (-1, [0, 0], None)
\end{minted}
\end{itemize}
\end{itemize}


\vspace{0.25cm}
\noindent\textbf{Advantages:} 
\begin{itemize}
    \item Effectively handles complex and extensive optimization issues by decomposing them into manageable subproblems.
    \item Iteratively expands the solution space with only the most promising variables, ensuring steady improvement towards optimality.
    \item Combines heuristic techniques for initial pattern generation with exact methods for precise optimization, balancing computational time and solution quality.
    \item Restricts the master problem to a subset of columns, avoiding the computational burden of an exponentially large problem and maintaining scalability.
    \item Achieves higher-quality solutions by selectively incorporating the most beneficial patterns, reducing overall computational effort and speeding up the optimization process.
\end{itemize}

\vspace{0.35cm}

\noindent\textbf{Disadvantages:}
\begin{itemize}
    \item Can be highly demanding in terms of computation, particularly for problems requiring numerous iterations or exact pattern generation.
    \item Requires specialized expertise and can be challenging to implement correctly.
    \item Performance and convergence are significantly influenced by the quality of the initial set of patterns.
    \item Solutions often yield fractional values that need further refinement to become practical, potentially increasing overall complexity.
    \item Solving large-scale problems may lead to numerical instability and high memory usage, limiting scalability in some cases.
\end{itemize}



\section{Modeling}
\section{Analyze result}
To evaluate the our model. The initial cutting plans were carried out using the standalone software optiCutter and CutList Optimizer (hyperlink nha Kỳ Nam). These same cutting plans were then implemented using our model to compare its level of effectiveness
\subsection{General Assessment}
This report will be evaluate by these indexes : 
\begin{itemize}
    \item \textbf{Stock Area Used: } is the cumulative area of raw material sheets employed to fulfill the cutting requirements in the 2D Cutting Stock Problem
    \item \textbf{Filled Ratio:}  is the ratio of the Stock Area Used to the Total Stock Area, indicating how much of the available material is successfully employed in the cutting process.
     \[
    \textit{Filled Ratio} = \frac{\textit{Stock Area Used}}{\textit{Total Stock Area}}
    \]
    \item \textbf{Trim Loss:} is the average ratio of the unused area to the total area of each stock sheet after cutting the required items. It indicates how much material is wasted during the cutting process, with a lower trim loss representing higher material efficiency.
    \[
    \textit{Trim Loss} = \frac{1}{n} \sum_{i=1}^{n} \frac{\textit{Stock Area}_i - \textit{Items Area on Stock}_i}{\textit{Stock Area}_i}
    \]
    \begin{flushright}
        \centering
        \footnotesize{Note: \( n \) is the number of used stocks.}
    \end{flushright}
\item \textbf{Time:} is the average computational duration needed to solve the 2D Cutting Stock Problem across all problem instances. It provides an indicator of the algorithm’s performance, where a lower time signifies a more efficient and faster-solving method.
\end{itemize}
Below, we present the average evaluation results based on 100 runs of randomized test cases

 \begin{table}[h!]
        \centering
        \begin{tabular}{|c|c|c|c|c|}
            \hline
            \textbf{} & \textbf{optiCutter} & \textbf{Greedy} & \textbf{Column Generation} & \textbf{Lazy Initialization} \\ \hline
            \textbf{Filled Ratio} & - & - & - & - \\ \hline
            \textbf{Trim Loss} & - & - & - & - \\ \hline
            \textbf{Time} & - & - & - & - \\ \hline
        \end{tabular}
\end{table}
\subsection{Case Study}

\subsubsection{Case Study 1}

\subsubsection*{Scenario}
Factory \textbf{Z} manufactures a wide array of plastic components và employs five different stock sheet types to cater to various product dimensions.

\subsubsection*{Available Stock}
\begin{table}[H]
    \centering
    \caption{Available Stock for Factory Z}
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Stock Type} & \textbf{Quantity} & \textbf{Width (cm)} & \textbf{Length (cm)} \\ \hline
        1 & 20 & 40 & 50 \\ \hline
        2 & 20 & 55 & 45 \\ \hline
        3 & 20 & 70 & 60 \\ \hline
        4 & 20 & 80 & 65 \\ \hline
        5 & 20 & 95 & 75 \\ \hline
    \end{tabular}
\end{table}

\subsubsection*{Product Requirements}
\begin{table}[H]
    \centering
    \caption{Product Requirements for Factory Z}
    \begin{tabular}{|c|c|}
        \hline
        \textbf{Product Size (cm)} & \textbf{Quantity Required} \\ \hline
        20 × 15 & 20 \\ \hline
        25 × 20 & 18 \\ \hline
        35 × 30 & 15 \\ \hline
        40 × 35 & 12 \\ \hline
        45 × 40 & 10 \\ \hline
        50 × 45 & 8 \\ \hline
        60 × 50 & 6 \\ \hline
        70 × 55 & 4 \\ \hline
        85 × 65 & 3 \\ \hline
    \end{tabular}
\end{table}
\subsubsection*{Evaluation}
\begin{figure}[H] % Sử dụng [H] để cố định vị trí
  \centering
  
  % Hàng 1
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/1.png}
    \caption{Hình 1}
    \label{fig:1}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/2.png}
    \caption{Hình 2}
    \label{fig:2}
  \end{subfigure}
  
  \vspace{0.3cm} % Giảm khoảng cách giữa các hàng
  
  % Hàng 2
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/3.png}
    \caption{Hình 3}
    \label{fig:3}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/4.png}
    \caption{Hình 4}
    \label{fig:4}
  \end{subfigure}
  
  \vspace{0.3cm} % Giảm khoảng cách giữa các hàng
  
  % Hàng 3
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/5.png}
    \caption{Hình 5}
    \label{fig:5}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{nho/6.png}
    \caption{Hình 6}
    \label{fig:6}
  \end{subfigure}
                                                           
  \label{fig:all_images}
\end{figure}
\begin{table}[H]
        \centering
        \caption{Evaluation Using Our Code}
        \begin{tabular}{|c|c|c|c|c|}
            \hline
            \textbf{} & \textbf{optiCutter} & \textbf{Greedy} & \textbf{Column Generation} & \textbf{Lazy Initialization} \\ \hline
             \textbf{Stock Area Used} & 39030 & 46678 & - & 42252 \\ \hline
            \textbf{Filled Ratio} & 0.096 & 0.114 & - & 0.104 \\ \hline
            \textbf{Trim Loss} & 0.028 & 0.195 & - & 0.102 \\ \hline
            \textbf{Time} & - & 30.754 & - & 36.106 \\ \hline
        \end{tabular}
    \end{table}

\subsubsection{Case Study 2}

\subsubsection*{Scenario}
Factory \textbf{Z} manufactures a wide array of plastic components và employs five different stock sheet types to cater to various product dimensions.

\subsubsection*{Available Stock}
\begin{table}[H]
    \centering
    \caption{Available Stock for Factory Z}
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Stock Type} & \textbf{Quantity} & \textbf{Width (cm)} & \textbf{Length (cm)} \\ \hline
        1 & 20 & 40 & 50 \\ \hline
        2 & 20 & 55 & 45 \\ \hline
        3 & 20 & 70 & 60 \\ \hline
        4 & 20 & 80 & 65 \\ \hline
        5 & 20 & 95 & 75 \\ \hline
    \end{tabular}
\end{table}

\subsubsection*{Product Requirements}
\begin{table}[H]
    \centering
    \caption{Product Requirements for Factory Z}
    \begin{tabular}{|c|c|}
        \hline
        \textbf{Product Size (cm)} & \textbf{Quantity Required} \\ \hline
        20 × 15 & 20 \\ \hline
        25 × 20 & 18 \\ \hline
        35 × 30 & 15 \\ \hline
        40 × 35 & 12 \\ \hline
        45 × 40 & 10 \\ \hline
        50 × 45 & 8 \\ \hline
        60 × 50 & 6 \\ \hline
        70 × 55 & 4 \\ \hline
        85 × 65 & 3 \\ \hline
    \end{tabular}
\end{table}
\subsubsection*{Evaluation}
\begin{figure}[H] % Sử dụng [H] để cố định vị trí
  \centering
  % Hàng 1
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_1.png}
    \caption{Hình 1}
    \label{fig:1}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_2.png}
    \caption{Hình 2}
    \label{fig:2}
  \end{subfigure}
  
  \vspace{0.3cm} % Giảm khoảng cách giữa các hàng
  
  % Hàng 2
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_3.png}
    \caption{Hình 3}
    \label{fig:3}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_4.png}
    \caption{Hình 4}
    \label{fig:4}
  \end{subfigure}
  
  \vspace{0.3cm} % Giảm khoảng cách giữa các hàng
  
  % Hàng 3
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_5.png}
    \caption{Hình 5}
    \label{fig:5}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{5type/5_6.png}
    \caption{Hình 6}
    \label{fig:6}
  \end{subfigure}
                                                           
  \label{fig:all_images}
\end{figure}
\begin{table}[H]
        \centering
        \caption{Evaluation Using Our Code}
        \begin{tabular}{|c|c|c|c|c|}
            \hline
            \textbf{} & \textbf{optiCutter} & \textbf{Greedy} & \textbf{Column Generation} & \textbf{Lazy Initialization} \\ \hline
             \textbf{Stock Used Area} & 57625 & 72700 & - & 65000 \\ \hline
            \textbf{Filled Ratio} & 0.137 & 0.173 & - & 0.154 \\ \hline
            \textbf{Trim Loss} & 0.108 & 0.296 & - & 0.234 \\ \hline
            \textbf{Time} & - & 6.224 & - & 6.311 \\ \hline
        \end{tabular}
    \end{table}
 \subsubsection{Case Study 2:}

\subsubsection*{Scenario}
Factory \textbf{Y} produces a range of metal parts và utilizes three distinct types of stock sheets to accommodate different product sizes.

\subsubsection*{Available Stock}
\begin{table}[h!]
    \centering
    \caption{Available Stock for Factory Y}
    \begin{tabular}{|c|c|c|}
        \hline
        \textbf{Stock Type} & \textbf{Quantity} & \textbf{Dimensions (Width × Length in cm)} \\ \hline
        1 & 34 & 60 cm × 45 cm \\ \hline
        2 & 33 & 75 cm × 60 cm \\ \hline
        3 & 33 & 90 cm × 80 cm \\ \hline
    \end{tabular}
\end{table}

\subsubsection*{Product Requirements}
\begin{table}[h!]
    \centering
    \caption{Product Requirements for Y}
    \begin{tabular}{|c|c|}
        \hline
        \textbf{Product Size (cm)} & \textbf{Quantity Required} \\ \hline
        20 × 15 & 20 \\ \hline
        30 × 25 & 15 \\ \hline
        40 × 30 & 12 \\ \hline
        45 × 40 & 10 \\ \hline
        50 × 45 & 8 \\ \hline
        70 × 50 & 6 \\ \hline
        80 × 60 & 4 \\ \hline
    \end{tabular}
\end{table}
\subsubsection*{Evaluation}
% ====== Figure 1: Hình 1 đến Hình 5 ======
\begin{figure}[H] % Sử dụng [H] để cố định vị trí
  \centering
  \captionsetup{justification=centering, font=small} % Tùy chỉnh căn chỉnh và kích thước chữ chú thích
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_1.png}
    \caption{Hình 1}
    \label{fig:1}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_2.png}
    \caption{Hình 2}
    \label{fig:2}
  \end{subfigure}

  \vspace{10cm} % Khoảng cách giữa các hàng
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_3.png}
    \caption{Hình 3}
    \label{fig:3}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_4.png}
    \caption{Hình 4}
    \label{fig:4}
  \end{subfigure}
  
  \vspace{0.1cm}
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_5.png}
    \caption{Hình 5}
    \label{fig:5}
  \end{subfigure}
  
  \label{fig:all_images_part1}
\end{figure}

% ====== Figure 2: Hình 6 đến Hình 10 ======
\begin{figure}[H] % Sử dụng [H] để cố định vị trí
  \centering
  \captionsetup{justification=centering, font=small} % Tùy chỉnh căn chỉnh và kích thước chữ chú thích
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_6.png}
    \caption{Hình 6}
    \label{fig:6}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_7.png}
    \caption{Hình 7}
    \label{fig:7}
  \end{subfigure}
  
  \vspace{0.1cm} % Khoảng cách giữa các hàng
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_8.png}
    \caption{Hình 8}
    \label{fig:8}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_9.png}
    \caption{Hình 9}
    \label{fig:9}
  \end{subfigure}
  
  \vspace{10cm}
  
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{3type/3_10.png}
    \caption{Hình 10}
    \label{fig:10}
  \end{subfigure}
  
  \label{fig:all_images_part2}
\end{figure}
 \begin{table}[H]
        \centering
        \caption{Evaluation Using Our Code}
        \begin{tabular}{|c|c|c|c|c|}
            \hline
            \textbf{} & \textbf{optiCutter} & \textbf{Greedy} & \textbf{Column Generation} & \textbf{Lazy Initialization} \\ \hline
            \textbf{Stock Used Area} & 57625 & - & - & - \\ \hline
            \textbf{Filled Ratio} & 0.137 & - & - & - \\ \hline
            \textbf{Trim Loss} & 0.108 & - & - & - \\ \hline
            \textbf{Time} & - & - & - & - \\ \hline
        \end{tabular}
\end{table}   
\section{Conclusion}

The two-dimensional Cutting Stock Problem (2D CSP) remains a critical challenge in industries aiming to optimize material usage and reduce costs. This report has examined the complexities of 2D CSP and evaluated effective algorithmic approaches, notably the \textbf{Lazy Stock Initialization Heuristic} and \textbf{Column Generation}.

The Lazy Stock Initialization Heuristic proved advantageous by minimizing initial computational and memory demands through deferred evaluation of cutting patterns. This approach enhances scalability and flexibility, making it suitable for large-scale problems. Meanwhile, Column Generation efficiently manages the exponential number of potential cutting patterns by iteratively incorporating only the most promising ones, thereby improving solution quality and computational efficiency.

Our case studies demonstrated that the proposed models perform competitively against established cutting software, highlighting their practical applicability in real-world scenarios. Despite the benefits, these methods introduce implementation complexities and may incur increased runtime under certain conditions.

Future research could explore hybridizing these techniques with other optimization methods, such as genetic algorithms, to further enhance performance. Additionally, integrating predictive models to identify promising cutting patterns could streamline the optimization process.

In summary, the strategies discussed in this report offer valuable tools for addressing the 2D Cutting Stock Problem, enabling industries to achieve greater material efficiency and cost savings. Continued advancements in optimization algorithms will further bolster the effectiveness and applicability of these solutions in diverse industrial applications.
\subsection{Future Research and Extensibility}

\begin{itemize}

    \item \textbf{Hybrid Optimization Methods} Combine heuristic algorithms like Genetic Algorithms with exact techniques such as Column Generation to enhance solution quality and reduce computation time.
    
    \item \textbf{Machine Learning Integration} Utilize machine learning models to predict and prioritize promising cutting patterns, thereby streamlining the optimization process.
    
    \item \textbf{Real-Time and Dynamic Optimization} Develop algorithms capable of adapting to real-time changes in demand, material availability, and production schedules to improve operational flexibility.
    
    \item[ \textbf{Enhanced Constraint Handling} Incorporate additional real-world constraints such as multiple material types, specific orientation requirements, and cutting sequence limitations to increase model robustness.
    
    \item \textbf{Scalability Improvements} Optimize algorithms for better scalability by implementing parallel processing, advanced memory management, and leveraging high-performance computing resources.

    
    \item \textbf{Empirical Validation} Conduct extensive empirical studies and benchmark against state-of-the-art methods to validate performance, identify limitations, and guide further improvements through industry collaborations.

\end{itemize}
\begin{thebibliography}{80}

\bibitem{TSP}
Introduction to TSP
``\textbf{link: https://en.wikipedia.org/wiki/Travelling\_salesman\_problem}'',
\textit{Travelling salesman problem}.

\bibitem{B&B}
Branch and Bound introduction
``\textbf{link: https://www.geeksforgeeks.org/branch-and-bound-algorithm/}'', \textit{Branch and Bound Algorithm}

\bibitem{B&B}
LAZY
``\textbf{link: https://en.wikipedia.org/wiki/Lazy_initialization}'', \textit{LAZY}


\end{thebibliography}
\end{document}